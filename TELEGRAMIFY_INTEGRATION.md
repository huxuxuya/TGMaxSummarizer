# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è telegramify-markdown

## üìã –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `telegramify-markdown` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown –≤ —Ñ–æ—Ä–º–∞—Ç Telegram MarkdownV2.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install telegramify-markdown
```

–ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

## üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ù–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–≤–∞ –Ω–æ–≤—ã—Ö —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ `TextContentType`:

- **`STANDARD_MARKDOWN`** - –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown —Ç–µ–∫—Å—Ç–∞
- **`HTML`** - –¥–ª—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã

#### `convert_standard_markdown_to_telegram(markdown_text: str) -> str`
–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Markdown –≤ Telegram MarkdownV2 –∏—Å–ø–æ–ª—å–∑—É—è `telegramify-markdown`.

#### `convert_html_to_telegram_markdown(html_text: str) -> str`
–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç HTML –≤ Telegram MarkdownV2 (—Å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤ Markdown).

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown

```python
from telegram_message_sender import TelegramMessageSender
from telegram_formatter import TextContentType

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Markdown —Ç–µ–∫—Å—Ç
markdown_text = """
# –ó–∞–≥–æ–ª–æ–≤–æ–∫
**–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç** –∏ *–∫—É—Ä—Å–∏–≤*

- –°–ø–∏—Å–æ–∫
- –≠–ª–µ–º–µ–Ω—Ç—ã

[–°—Å—ã–ª–∫–∞](https://example.com)
"""

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π
await TelegramMessageSender.safe_send_message(
    bot=bot,
    chat_id=chat_id,
    text=markdown_text,
    content_type=TextContentType.STANDARD_MARKDOWN,
    parse_mode=ParseMode.MARKDOWN_V2
)
```

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```python
html_text = """
<h1>–û—Ç—á–µ—Ç</h1>
<p><strong>–°—Ç–∞—Ç—É—Å</strong>: –£—Å–ø–µ—à–Ω–æ</p>
<p><em>–í—Ä–µ–º—è</em>: 2.5 —Å–µ–∫—É–Ω–¥—ã</p>
"""

await TelegramMessageSender.safe_send_message(
    bot=bot,
    chat_id=chat_id,
    text=html_text,
    content_type=TextContentType.HTML,
    parse_mode=ParseMode.MARKDOWN_V2
)
```

### 3. –ü—Ä—è–º–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

```python
# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown
telegram_text = TelegramMessageSender.convert_standard_markdown_to_telegram(markdown_text)

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è HTML
telegram_text = TelegramMessageSender.convert_html_to_telegram_markdown(html_text)
```

## üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Markdown
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ (`#`, `##`, `###`)
- ‚úÖ –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç (`**bold**`)
- ‚úÖ –ö—É—Ä—Å–∏–≤ (`*italic*`)
- ‚úÖ –°—Å—ã–ª–∫–∏ (`[text](url)`)
- ‚úÖ –°–ø–∏—Å–∫–∏ (`-`, `*`, `1.`)
- ‚úÖ –ö–æ–¥ (`\`code\``, `\`\`\`block\`\`\``)
- ‚úÖ –¶–∏—Ç–∞—Ç—ã (`> quote`)
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã (–±–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞)

### HTML
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ (`<h1>`, `<h2>`, `<h3>`)
- ‚úÖ –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç (`<b>`, `<strong>`)
- ‚úÖ –ö—É—Ä—Å–∏–≤ (`<i>`, `<em>`)
- ‚úÖ –ö–æ–¥ (`<code>`, `<pre>`)
- ‚úÖ –°—Å—ã–ª–∫–∏ (`<a href="...">`)

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ Fallback

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Fallback
–ï—Å–ª–∏ `telegramify-markdown` –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π fallback –º–µ—Ç–æ–¥

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –°–∫–æ—Ä–æ—Å—Ç—å | –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å |
|-------|----------|------------------|------------|
| `telegramify-markdown` | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |
| –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤—â–∏–∫ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| HTML –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: `telegramify-markdown` –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
2. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ `requirements.txt`
3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
4. **Fallback**: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```bash
python example_telegramify_usage.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é HTML
- –†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

### ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è**

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω! –í—Å–µ LLM –æ—Ç–≤–µ—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç telegramify-markdown.

### –î–æ (—Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±)
```python
# –†—É—á–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
formatted_text = TelegramFormatter.smart_escape_markdown_v2(text)
```

### –ü–æ—Å–ª–µ (–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–±)
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ telegramify-markdown
await TelegramMessageSender.safe_send_message(
    bot=bot,
    chat_id=chat_id,
    text=markdown_text,
    content_type=TextContentType.STANDARD_MARKDOWN,
    parse_mode=ParseMode.MARKDOWN_V2
)
```

## üöÄ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞**

### ‚úÖ **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:**

1. **chat_analyzer.py** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å—Ç—ã–π Markdown –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
2. **utils.py** - —Å—Ç–∞—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã, –Ω–æ–≤—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç telegramify-markdown
3. **telegram_formatter.py** - format_analysis_result_with_reflection() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Markdown
4. **handlers.py** - –≤—Å–µ LLM –æ—Ç–≤–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç TextContentType.STANDARD_MARKDOWN
5. **telegram_message_sender.py** - —É–ª—É—á—à–µ–Ω error handling –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### ‚úÖ **–ß—Ç–æ —Ä–µ—à–µ–Ω–æ:**

- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞ —Å –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–º–∏ bold —Ç–µ–≥–∞–º–∏** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ telegramify-markdown
- ‚ùå **–û—à–∏–±–∫–∞ "can't find end of bold entity"** - –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç
- ‚ùå **–°–ª–æ–∂–Ω—ã–µ —Å–ø–∏—Å–∫–∏ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ùå **–í–ª–æ–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

### ‚úÖ **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- üéØ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è** —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Markdown –≤ Telegram MarkdownV2
- üõ°Ô∏è **–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º
- üîÑ **–ù–∞–¥–µ–∂–Ω—ã–π fallback** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- üìä **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è debugging

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [telegramify-markdown GitHub](https://github.com/sudoskys/telegramify-markdown)
- [Telegram Bot API MarkdownV2](https://core.telegram.org/bots/api#markdownv2-style)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](example_telegramify_usage.py)
